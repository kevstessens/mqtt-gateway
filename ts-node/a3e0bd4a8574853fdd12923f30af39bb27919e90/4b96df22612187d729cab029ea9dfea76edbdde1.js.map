{"version":3,"file":"/root/code/mqtt-gateway/app/authorization/can_use_topic.ts","sources":["/root/code/mqtt-gateway/app/authorization/can_use_topic.ts"],"names":[],"mappings":";AAAA,oCAAgC;AAEhC;kCACkC;AAClC,qBAA4B,MAAM,EAAE,KAAK;IACrC,IAAI,MAAM,GAAG,KAAK;QACd,MAAM;QACN,MAAM,CAAC,WAAW;QAClB,MAAM,CAAC,WAAW,CAAC,GAAG,CAAC;IAC3B,EAAE,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC;QACV,YAAG,CAAC,wBAAwB;YACxB,CAAC,KAAK,IAAI,KAAK,CAAC;YAChB,6BAA6B,CAAC,CAAC;QACnC,MAAM,CAAC,KAAK,CAAC;IACjB,CAAC;IAAA,CAAC;IACF,IAAI,KAAK,GAAG,MAAM,CAAC,WAAW,CAAC,GAAG,CAAC;IACnC,IAAI,YAAY,GAAG,MAAM,GAAG,KAAK,CAAC;IAClC,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC,YAAY,CAAC,CAAC;AAC1C,CAAC;AAdD,kCAcC","sourcesContent":["import { log } from \"../logger\";\n\n/** If a user has a bot of id XYZ, then they may access any topic\n *  following pattern bot/XYZ/# */\nexport function canUseTopic(client, topic) {\n    let hasBot = topic &&\n        client &&\n        client.permissions &&\n        client.permissions.bot;\n    if (!hasBot) {\n        log(\"Tried to access topic \" +\n            (topic || \"???\") +\n            \" but no bot/topic provided.\");\n        return false;\n    };\n    let botID = client.permissions.bot;\n    let allowedTopic = \"bot/\" + botID;\n    return topic.startsWith(allowedTopic);\n}"]}